{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\"; \nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst API_KEY = \"41828858-bc9e123a5e007e4f9a3f52776\";\nconst form = document.querySelector('.container');\nconst input = document.querySelector('input');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more');\n\nconst options = {\n    captionsData: 'alt',\n    captionDelay: 250,\n};\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n\n    try {\n        searchQuery = encodeURIComponent(input.value.trim());\n\n        if (!searchQuery) {\n            iziToast.error({\n                title: 'Invalid Input',\n                message: 'Please enter a search term.',\n            });\n            return;\n        }\n        loader.style.display = 'block';\n\n        const url = `https://pixabay.com/api/?key=${API_KEY}&q=${searchQuery}&page=${currentPage}&per_page=${perPage}`;\n        const response = await axios.get(url);\n\n        if (response.status !== 200) {\n            throw new Error('Failed to fetch images. Please try again later.');\n        }\n\n        const hits = response.data.hits;\n\n        loader.style.display = 'none';\n        gallery.innerHTML = '';\n\n        if (hits.length === 0) {\n            iziToast.error({\n                title: 'No Results',\n                message: 'No images found. Please try a different search term.',\n            });\n            return;\n        }\n\n        gallery.innerHTML = hits.reduce((html, hit) => html + `\n            <li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${hit.webformatURL}\">\n                    <img class=\"gallery-image\" src=\"${hit.previewURL}\" alt=\"${hit.tags}\" />\n                </a>\n                <div class=\"content\">\n                    <h4 class=\"titles\">Likes</h4>\n                    <h4 class=\"titles\">Views</h4>\n                    <h4 class=\"titles\">Comments</h4>\n                    <h4 class=\"titles\">Downloads</h4>\n                    <p class=\"text\">${hit.likes}</p>\n                    <p class=\"text\">${hit.views}</p>\n                    <p class=\"text\">${hit.comments}</p>\n                    <p class=\"text\">${hit.downloads}</p>\n                </div>\n            </li>`, \"\");\n\n        if (hits.length >= perPage) {\n            loadMoreButton.style.display = 'block';\n        } else {\n            loadMoreButton.style.display = 'none';\n        }\n\n    } catch (error) {\n        console.error('Error fetching data:', error);\n\n        if (error instanceof TypeError) {\n            iziToast.error({\n                title: 'Network Error',\n                message: 'Please check your internet connection and try again.',\n            });\n        } else {\n            iziToast.error({\n                title: 'Error',\n                message: error.message,\n            });\n        }\n    }\n});\n\nlet currentPage = 1;\nconst perPage = 40;\nlet searchQuery = '';\nlet allHits = [];\nlet isFirstLoad = true;\n\nlet cardHeight = 0;\n\nloadMoreButton.addEventListener('click', async () => {\n\n    try {\n        loader.style.display = 'block';\n\n        if (isFirstLoad || searchQuery !== encodeURIComponent(input.value.trim())) {\n            allHits = [];\n            currentPage = 1;\n            isFirstLoad = false;\n        }\n\n        searchQuery = encodeURIComponent(input.value.trim());\n        const url = `https://pixabay.com/api/?key=${API_KEY}&q=${searchQuery}&page=${currentPage}&per_page=${perPage}`;\n        const response = await axios.get(url);\n\n        if (response.status !== 200) {\n            throw new Error('Failed to fetch more images. Please try again later.');\n        }\n\n        const additionalHits = response.data.hits;\n\n        loader.style.display = 'none';\n\n        if (additionalHits.length === 0) {\n            loadMoreButton.style.display = 'none';\n            iziToast.info({\n                title: 'End of Collection',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n            return;\n        }\n\n        allHits = [...allHits, ...additionalHits];\n        \n\n        gallery.innerHTML = allHits.slice(0, currentPage * perPage).reduce((html, hit) => html + `\n            <li class=\"gallery-item\">\n                <a class=\"gallery-link\" href=\"${hit.webformatURL}\">\n                    <img class=\"gallery-image\" src=\"${hit.previewURL}\" alt=\"${hit.tags}\" />\n                </a>\n                <div class=\"content\">\n                    <h4 class=\"titles\">Likes</h4>\n                    <h4 class=\"titles\">Views</h4>\n                    <h4 class=\"titles\">Comments</h4>\n                    <h4 class=\"titles\">Downloads</h4>\n                    <p class=\"text\">${hit.likes}</p>\n                    <p class=\"text\">${hit.views}</p>\n                    <p class=\"text\">${hit.comments}</p>\n                    <p class=\"text\">${hit.downloads}</p>\n                </div>\n            </li>`, \"\");\n        \n        const firstGalleryItem = document.querySelector('.gallery-item');\n        if (firstGalleryItem) {\n            const { height } = firstGalleryItem.getBoundingClientRect();\n            cardHeight = height;\n        }\n\n        smoothScrollBy(0, 2 * cardHeight);\n\n        lightbox.refresh();\n\n        currentPage++;\n\n        if (currentPage * perPage >= response.data.totalHits) {\n            loadMoreButton.style.display = 'none';\n            iziToast.info({\n                title: 'End of Collection',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        } else {\n            loadMoreButton.style.display = 'block';\n        }\n    } catch (error) {\n        console.error('Помилка при отриманні додаткових даних:', error);\n    }\n});\n\nfunction smoothScrollBy(x, y) {\n    window.scrollBy({\n        top: y,\n        left: x,\n        behavior: 'smooth'\n    });\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', options);"],"names":["API_KEY","form","input","gallery","loader","loadMoreButton","options","event","searchQuery","iziToast","url","currentPage","perPage","response","axios","hits","html","hit","error","allHits","isFirstLoad","cardHeight","additionalHits","firstGalleryItem","height","smoothScrollBy","lightbox","x","y","SimpleLightbox"],"mappings":"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"}